import{ap as c,an as I,bR as _,bS as G,aq as m,ay as k,bT as A,bU as y,m as M,bV as v}from"./installCanvasRenderer-BM3_8jvr.js";var u=G();function H(n){var t=n.mainData,e=n.datas;e||(e={main:t},n.datasAttr={main:"data"}),n.datas=n.mainData=null,E(t,e,n),c(e,function(a){c(t.TRANSFERABLE_METHODS,function(i){a.wrapMethod(i,I(S,n))})}),t.wrapMethod("cloneShallow",I(R,n)),c(t.CHANGABLE_METHODS,function(a){t.wrapMethod(a,I(L,n))}),_(e[t.dataType]===t)}function S(n,t){if(V(this)){var e=m({},u(this).datas);e[this.dataType]=t,E(t,e,n)}else x(t,this.dataType,u(this).mainData,n);return t}function L(n,t){return n.struct&&n.struct.update(),t}function R(n,t){return c(u(t).datas,function(e,a){e!==t&&x(e.cloneShallow(),a,t,n)}),t}function T(n){var t=u(this).mainData;return n==null||t==null?t:u(t).datas[n]}function b(){var n=u(this).mainData;return n==null?[{data:n}]:k(A(u(n).datas),function(t){return{type:t,data:u(n).datas[t]}})}function V(n){return u(n).mainData===n}function E(n,t,e){u(n).datas={},c(t,function(a,i){x(a,i,n,e)})}function x(n,t,e,a){u(e).datas[t]=n,u(n).mainData=e,n.dataType=t,a.struct&&(n[a.structAttr]=a.struct,a.struct[a.datasAttr[t]]=n),n.getLinkedData=T,n.getLinkedDataAll=b}function l(n){return"_EC_"+n}var q=function(){function n(t){this.type="graph",this.nodes=[],this.edges=[],this._nodesMap={},this._edgesMap={},this._directed=t||!1}return n.prototype.isDirected=function(){return this._directed},n.prototype.addNode=function(t,e){t=t==null?""+e:""+t;var a=this._nodesMap;if(!a[l(t)]){var i=new f(t,e);return i.hostGraph=this,this.nodes.push(i),a[l(t)]=i,i}},n.prototype.getNodeByIndex=function(t){var e=this.data.getRawIndex(t);return this.nodes[e]},n.prototype.getNodeById=function(t){return this._nodesMap[l(t)]},n.prototype.addEdge=function(t,e,a){var i=this._nodesMap,d=this._edgesMap;if(y(t)&&(t=this.nodes[t]),y(e)&&(e=this.nodes[e]),t instanceof f||(t=i[l(t)]),e instanceof f||(e=i[l(e)]),!(!t||!e)){var s=t.id+"-"+e.id,r=new D(t,e,a);return r.hostGraph=this,this._directed&&(t.outEdges.push(r),e.inEdges.push(r)),t.edges.push(r),t!==e&&e.edges.push(r),this.edges.push(r),d[s]=r,r}},n.prototype.getEdgeByIndex=function(t){var e=this.edgeData.getRawIndex(t);return this.edges[e]},n.prototype.getEdge=function(t,e){t instanceof f&&(t=t.id),e instanceof f&&(e=e.id);var a=this._edgesMap;return this._directed?a[t+"-"+e]:a[t+"-"+e]||a[e+"-"+t]},n.prototype.eachNode=function(t,e){for(var a=this.nodes,i=a.length,d=0;d<i;d++)a[d].dataIndex>=0&&t.call(e,a[d],d)},n.prototype.eachEdge=function(t,e){for(var a=this.edges,i=a.length,d=0;d<i;d++)a[d].dataIndex>=0&&a[d].node1.dataIndex>=0&&a[d].node2.dataIndex>=0&&t.call(e,a[d],d)},n.prototype.breadthFirstTraverse=function(t,e,a,i){if(e instanceof f||(e=this._nodesMap[l(e)]),!!e){for(var d=a==="out"?"outEdges":a==="in"?"inEdges":"edges",s=0;s<this.nodes.length;s++)this.nodes[s].__visited=!1;if(!t.call(i,e,null))for(var r=[e];r.length;)for(var o=r.shift(),h=o[d],s=0;s<h.length;s++){var g=h[s],p=g.node1===o?g.node2:g.node1;if(!p.__visited){if(t.call(i,p,o))return;r.push(p),p.__visited=!0}}}},n.prototype.update=function(){for(var t=this.data,e=this.edgeData,a=this.nodes,i=this.edges,d=0,s=a.length;d<s;d++)a[d].dataIndex=-1;for(var d=0,s=t.count();d<s;d++)a[t.getRawIndex(d)].dataIndex=d;e.filterSelf(function(r){var o=i[e.getRawIndex(r)];return o.node1.dataIndex>=0&&o.node2.dataIndex>=0});for(var d=0,s=i.length;d<s;d++)i[d].dataIndex=-1;for(var d=0,s=e.count();d<s;d++)i[e.getRawIndex(d)].dataIndex=d},n.prototype.clone=function(){for(var t=new n(this._directed),e=this.nodes,a=this.edges,i=0;i<e.length;i++)t.addNode(e[i].id,e[i].dataIndex);for(var i=0;i<a.length;i++){var d=a[i];t.addEdge(d.node1.id,d.node2.id,d.dataIndex)}return t},n}(),f=function(){function n(t,e){this.inEdges=[],this.outEdges=[],this.edges=[],this.dataIndex=-1,this.id=t??"",this.dataIndex=e??-1}return n.prototype.degree=function(){return this.edges.length},n.prototype.inDegree=function(){return this.inEdges.length},n.prototype.outDegree=function(){return this.outEdges.length},n.prototype.getModel=function(t){if(!(this.dataIndex<0)){var e=this.hostGraph,a=e.data.getItemModel(this.dataIndex);return a.getModel(t)}},n.prototype.getAdjacentDataIndices=function(){for(var t={edge:[],node:[]},e=0;e<this.edges.length;e++){var a=this.edges[e];a.dataIndex<0||(t.edge.push(a.dataIndex),t.node.push(a.node1.dataIndex,a.node2.dataIndex))}return t},n.prototype.getTrajectoryDataIndices=function(){for(var t=v(),e=v(),a=0;a<this.edges.length;a++){var i=this.edges[a];if(!(i.dataIndex<0)){t.set(i.dataIndex,!0);for(var d=[i.node1],s=[i.node2],r=0;r<d.length;){var o=d[r];r++,e.set(o.dataIndex,!0);for(var h=0;h<o.inEdges.length;h++)t.set(o.inEdges[h].dataIndex,!0),d.push(o.inEdges[h].node1)}for(r=0;r<s.length;){var g=s[r];r++,e.set(g.dataIndex,!0);for(var h=0;h<g.outEdges.length;h++)t.set(g.outEdges[h].dataIndex,!0),s.push(g.outEdges[h].node2)}}}return{edge:t.keys(),node:e.keys()}},n}(),D=function(){function n(t,e,a){this.dataIndex=-1,this.node1=t,this.node2=e,this.dataIndex=a??-1}return n.prototype.getModel=function(t){if(!(this.dataIndex<0)){var e=this.hostGraph,a=e.edgeData.getItemModel(this.dataIndex);return a.getModel(t)}},n.prototype.getAdjacentDataIndices=function(){return{edge:[this.dataIndex],node:[this.node1.dataIndex,this.node2.dataIndex]}},n.prototype.getTrajectoryDataIndices=function(){var t=v(),e=v();t.set(this.dataIndex,!0);for(var a=[this.node1],i=[this.node2],d=0;d<a.length;){var s=a[d];d++,e.set(s.dataIndex,!0);for(var r=0;r<s.inEdges.length;r++)t.set(s.inEdges[r].dataIndex,!0),a.push(s.inEdges[r].node1)}for(d=0;d<i.length;){var o=i[d];d++,e.set(o.dataIndex,!0);for(var r=0;r<o.outEdges.length;r++)t.set(o.outEdges[r].dataIndex,!0),i.push(o.outEdges[r].node2)}return{edge:t.keys(),node:e.keys()}},n}();function w(n,t){return{getValue:function(e){var a=this[n][t];return a.getStore().get(a.getDimensionIndex(e||"value"),this.dataIndex)},setVisual:function(e,a){this.dataIndex>=0&&this[n][t].setItemVisual(this.dataIndex,e,a)},getVisual:function(e){return this[n][t].getItemVisual(this.dataIndex,e)},setLayout:function(e,a){this.dataIndex>=0&&this[n][t].setItemLayout(this.dataIndex,e,a)},getLayout:function(){return this[n][t].getItemLayout(this.dataIndex)},getGraphicEl:function(){return this[n][t].getItemGraphicEl(this.dataIndex)},getRawIndex:function(){return this[n][t].getRawIndex(this.dataIndex)}}}M(f,w("hostGraph","data"));M(D,w("hostGraph","edgeData"));export{q as G,H as l};
