import{d as C,ag as q,h,ah as A,D as I,V as F,W as M,s as N,r as u,c as _,o as m,b as s,a as o,g as P,Y as w,n as Z,w as p,F as G,q as H,a6 as S,aa as f,S as J,u as O,ai as Q}from"./index-0uBKbaiL.js";import{u as K}from"./upload-al-Z_kM4.js";import{_ as W}from"./plugin-vueexport-helper-DlAUqK2U.js";const X={class:"upload-box"},x=["src"],ee={key:1,class:"upload-empty"},le={class:"el-upload__tip"},ae=C({name:"UploadImg"}),te=C({...ae,props:{imageUrl:{default:""},api:{},drag:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1},fileSize:{default:5},fileType:{default:()=>["image/jpeg","image/png","image/gif"]},height:{default:"150px"},width:{default:"150px"},borderRadius:{default:"8px"}},emits:["update:imageUrl"],setup(z,{emit:E}){q(a=>({e5f82e1e:a.width,"0cab8948":a.height,"111f6a53":a.borderRadius}));const i=z,c=h("id-"+A()),g=h(!1),r=I(F,void 0),n=I(M,void 0),y=N(()=>i.disabled||(r==null?void 0:r.disabled)),U=E,k=async a=>{let t=new FormData;t.append("file",a.file);try{const e=i.api??K,{data:l}=await e(t);U("update:imageUrl",l.fileUrl),n!=null&&n.prop&&(r==null||r.validateField([n.prop]))}catch(e){a.onError(e)}},D=()=>{U("update:imageUrl","")},T=()=>{const a=document.querySelector(`#${c.value} .el-upload__input`);a&&a.dispatchEvent(new MouseEvent("click"))},V=a=>{const t=a.size/1024/1024<i.fileSize,e=i.fileType.includes(a.type);return e||f({title:"温馨提示",message:"上传图片不符合所需的格式！",type:"warning"}),t||setTimeout(()=>{f({title:"温馨提示",message:`上传图片大小不能超过 ${i.fileSize}M！`,type:"warning"})},0),e&&t},B=()=>{f({title:"温馨提示",message:"图片上传成功！",type:"success"})},$=()=>{f({title:"温馨提示",message:"图片上传失败，请您重新上传！",type:"error"})};return(a,t)=>{const e=u("Edit"),l=u("el-icon"),d=u("ZoomIn"),b=u("Delete"),L=u("Plus"),j=u("el-upload"),R=u("el-image-viewer");return m(),_("div",X,[s(j,{id:c.value,action:"#",class:Z(["upload",y.value?"disabled":"",a.drag?"no-border":""]),multiple:!1,disabled:y.value,"show-file-list":!1,"http-request":k,"before-upload":V,"on-success":B,"on-error":$,drag:a.drag,accept:a.fileType.join(",")},{default:p(()=>[a.imageUrl?(m(),_(G,{key:0},[o("img",{src:a.imageUrl,class:"upload-image"},null,8,x),o("div",{class:"upload-handle",onClick:t[1]||(t[1]=H(()=>{},["stop"]))},[y.value?w("",!0):(m(),_("div",{key:0,class:"handle-icon",onClick:T},[s(l,null,{default:p(()=>[s(e)]),_:1}),t[3]||(t[3]=o("span",null,"编辑",-1))])),o("div",{class:"handle-icon",onClick:t[0]||(t[0]=v=>g.value=!0)},[s(l,null,{default:p(()=>[s(d)]),_:1}),t[4]||(t[4]=o("span",null,"查看",-1))]),y.value?w("",!0):(m(),_("div",{key:1,class:"handle-icon",onClick:D},[s(l,null,{default:p(()=>[s(b)]),_:1}),t[5]||(t[5]=o("span",null,"删除",-1))]))])],64)):(m(),_("div",ee,[S(a.$slots,"empty",{},()=>[s(l,null,{default:p(()=>[s(L)]),_:1})],!0)]))]),_:3},8,["id","class","disabled","drag","accept"]),o("div",le,[S(a.$slots,"tip",{},void 0,!0)]),g.value?(m(),P(R,{key:0,"url-list":[a.imageUrl],onClose:t[2]||(t[2]=v=>g.value=!1)},null,8,["url-list"])):w("",!0)])}}}),ge=W(te,[["__scopeId","data-v-20d9999e"]]),se={class:"upload-box"},ie={class:"upload-empty"},oe=["src"],ne=["onClick"],de=["onClick"],ue={class:"el-upload__tip"},re=C({name:"UploadImgs"}),pe=C({...re,props:{fileList:{default:()=>[]},api:{},drag:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1},limit:{default:5},fileSize:{default:5},fileType:{default:()=>["image/jpeg","image/png","image/gif"]},height:{default:"150px"},width:{default:"150px"},borderRadius:{default:"8px"}},emits:["update:fileList"],setup(z,{emit:E}){q(e=>({"2ed68841":e.borderRadius,e5a30a7a:e.width,"025c386c":e.height}));const i=z,c=I(F,void 0),g=I(M,void 0),r=N(()=>i.disabled||(c==null?void 0:c.disabled)),n=h(i.fileList);J(()=>i.fileList,e=>{n.value=e});const y=e=>{const l=e.size/1024/1024<i.fileSize,d=i.fileType.includes(e.type);return d||f({title:"温馨提示",message:"上传图片不符合所需的格式！",type:"warning"}),l||setTimeout(()=>{f({title:"温馨提示",message:`上传图片大小不能超过 ${i.fileSize}M！`,type:"warning"})},0),d&&l},U=async e=>{let l=new FormData;l.append("file",e.file);try{const d=i.api??K,{data:b}=await d(l);e.onSuccess(b)}catch(d){e.onError(d)}},k=E,D=(e,l)=>{e&&(l.url=e.fileUrl,k("update:fileList",n.value),g!=null&&g.prop&&(c==null||c.validateField([g.prop])),f({title:"温馨提示",message:"图片上传成功！",type:"success"}))},T=e=>{n.value=n.value.filter(l=>l.url!==e.url||l.name!==e.name),k("update:fileList",n.value)},V=()=>{f({title:"温馨提示",message:"图片上传失败，请您重新上传！",type:"error"})},B=()=>{f({title:"温馨提示",message:`当前最多只能上传 ${i.limit} 张图片，请移除后上传！`,type:"warning"})},$=h(""),a=h(!1),t=e=>{$.value=e.url,a.value=!0};return(e,l)=>{const d=u("el-icon"),b=u("ZoomIn"),L=u("Delete"),j=u("el-upload"),R=u("el-image-viewer");return m(),_("div",se,[s(j,{"file-list":n.value,"onUpdate:fileList":l[1]||(l[1]=v=>n.value=v),action:"#","list-type":"picture-card",class:Z(["upload",r.value?"disabled":"",e.drag?"no-border":""]),multiple:!0,disabled:r.value,limit:e.limit,"http-request":U,"before-upload":y,"on-exceed":B,"on-success":D,"on-error":V,drag:e.drag,accept:e.fileType.join(",")},{file:p(({file:v})=>[o("img",{src:v.url,class:"upload-image"},null,8,oe),o("div",{class:"upload-handle",onClick:l[0]||(l[0]=H(()=>{},["stop"]))},[o("div",{class:"handle-icon",onClick:Y=>t(v)},[s(d,null,{default:p(()=>[s(b)]),_:1}),l[3]||(l[3]=o("span",null,"查看",-1))],8,ne),r.value?w("",!0):(m(),_("div",{key:0,class:"handle-icon",onClick:Y=>T(v)},[s(d,null,{default:p(()=>[s(L)]),_:1}),l[4]||(l[4]=o("span",null,"删除",-1))],8,de))])]),default:p(()=>[o("div",ie,[S(e.$slots,"empty",{},()=>[s(d,null,{default:p(()=>[s(O(Q))]),_:1})],!0)])]),_:3},8,["file-list","class","disabled","limit","drag","accept"]),o("div",ue,[S(e.$slots,"tip",{},void 0,!0)]),a.value?(m(),P(R,{key:0,"url-list":[$.value],onClose:l[2]||(l[2]=v=>a.value=!1)},null,8,["url-list"])):w("",!0)])}}}),ve=W(pe,[["__scopeId","data-v-10385bea"]]);export{ve as U,ge as a};
